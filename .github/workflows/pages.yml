name: Build and publish documentation

on:
    push:
        branches: [main]

jobs:
    pages:
        runs-on: ubuntu-latest
        environment: packaging
        steps:
            - uses: actions/checkout@v2

            - name: Setup Python 3.10
              uses: actions/setup-python@v2
              with:
                  python-version: '3.10'

            - name: Install pdoc
              run: pip install pdoc

            - name: Build documentation
              run: |
                  cd docs
                  ./build.sh

            - name: Upload pages
              uses: actions/upload-artifacts@v2
              with:
                  name: pages
                  path: docs/build

            - name: Publish pages
              uses: actions/deploy-pages
