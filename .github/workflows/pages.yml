name: Build and publish documentation

on:
    push:
        branches: [main]

jobs:
    pages:
        runs-on: ubuntu-latest
        steps:
            - uses: actions/checkout@v2

            - name: Setup Python 3.10
              uses: actions/setup-python@v2
              with:
                  python-version: '3.10'

            - name: Install poetry
              run: curl -sSL https://install.python-poetry.org | python3 -

            - name: Install project
              run: poetry install

            - name: Build documentation
              run: |
                  cd docs
                  poetry run ./build.sh

            - name: Upload pages
              uses: actions/upload-artifact@v2
              with:
                  name: pages
                  path: docs/build

            - name: Publish pages
              uses: actions/deploy-pages@479e82243a95585ebee8ab037c4bfd8e6356a47b
